import java.io.BufferedReader;
import java.io.IOException;
import java.io.InputStreamReader;

public class Util {
	
	static String getFilenameExtention(String filepath) {
		if (filepath == null)
			return "";
		
		int start = filepath.lastIndexOf('.');
		return filepath.substring(start + 1);	
	}
	
	/* check whether the executable is signed or not 
	 * (improvement could be whether the signature is valid)
	 */
	static boolean isSigned(String path) {
		if (path == null || path.trim().length() == 0) {
			System.err.println("Util.isSigned: bad input arguments!");
			return false;
		}
		
		Runtime rt = Runtime.getRuntime();
		BufferedReader br = null;
		
		try {
			Process pr = rt.exec(new String[]{"sigcheck", path});
			br = new BufferedReader(new InputStreamReader(pr.getInputStream()));
			
			String filepath = br.readLine(); // this line is file path, abandoned
			String verified = br.readLine();
			String[] varr = verified.split("\t");
			br.close();
			
			return varr[2].equals("Signed") ? true : false;
		} catch (Exception e) {
			e.printStackTrace();
		} finally {
			try {
				if (br != null) 
					br.close();
			} catch (IOException ex) {
				ex.printStackTrace();
			}
		}
		return false;
	}
	
	
}
