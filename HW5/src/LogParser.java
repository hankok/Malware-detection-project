
public class LogParser {
	static int parseLine(String line) {
		if (line == null) {
			System.err.println("LogParser.parseLine: input arguments cannot be null!");
			return -3;
		}
		
		String[] strarr = line.split(" ");
		if (strarr.length == 0) {
			return 1; // filepath
		}
		
		if (strarr.length == 2 && strarr[1].equals("initialised")) {
			return -2; // initilise string, can skip
		}
		
		if (strarr[0].equals("Process")) {
			return 0; // process string (start | exit)
		}
		
		if (strarr[0].equals("Loaded")) {
			return -1; // loaded dll, can skip
		}
		
		if (strarr.length > 2 && strarr[2].startsWith("Nt")) {
			return 2; // Nt functions
		}
		
		return -3;
	}
	
	static int getPID(String line, int code) {
		String[] strarr = line.split(" ");
		if (code == 0) {
			return Integer.parseInt(strarr[1]);
		} else if (code == 2) {
			strarr = line.split(" ");
			String pid = strarr[1].substring(1, strarr[1].length() - 1);
			return Integer.parseInt(pid);
		} else {
			return -1;
		}
	}
	
	
}
